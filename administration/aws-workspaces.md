# Managing AWS WorkSpaces

> When generating passwords, use something like the
> [random.org password generator](https://www.random.org/passwords).

## Seven-Step Deployment and Management Process

AWS WorkSpaces house the production deployment of teams' problem statement
solutions. As the backbone of the submissions process, it is imperative these
WorkSpaces are always and immediately available to students and judges when
necessary. This is facilitated via a seven step process:

<small> -- must be completed at least two weeks before the due date of PS1 --
</small> \
Step 1: Setup "AWSWS" Worksheet in the HSCC Tracking Document \
Step 2: Setup WorkSpaces on AWS \
Step 3: Finalize Budget and Distribute Phase 1 Credentials

<small> -- must be completed when the PS1 submission window closes and phase 1
ends -- </small> \
Step 4: End Phase 1

<small> -- must be completed at least 30 minutes before phase 2 (and the HSCC
competition) begins -- </small> \
Step 5: Prepare for Phase 2

<small> -- must be completed after phase 2 ends (i.e. after the extra 1 hour
submission allowance) -- </small> \
Step 6: End Phase 2

<small> -- must be completed after the conference ends (usually around a month
after) -- </small> \
Step 7: Cleanup WorkSpaces

### Step 1: Setup "AWSWS" Worksheet in the HSCC Tracking Document

1. Gain access to this year's "HSCC 2XXX Tracking" document on Google Drive.

2. Navigate to the "AWSWS" tab, or create it if it does not already exist. Look
   at previous years' tracking documents for examples of the expected structure,
   which is described below:

   - Ensure one row exists for each chapter participating this year, and that
     there are no chapters listed that are not participating. Each row must
     have: chapter name, chapter abbreviation, AWSWS username ("2XXX-abc" for
     chapter "Abc" for year 2XXX), AWSWS password (randomly generated
     30-character password), and AWSWS registration code. The registration code
     is generated by AWS and will be the same across all workspaces.

   - Ensure one row exists for the NHSCC workspace, which should have "NHSCC" as
     the chapter name, no abbreviation, "2XXX-nhscc" as the AWSWS username, a
     randomly generated password, and the shared registration code.

   - Ensure one row exists for the **judge-specific password**. This must be a
     secure 3-character password and it must not be reused year-to-year. This
     password is used by judges to access the workspaces after submissions have
     closed for a phase.

### Step 2: Setup WorkSpaces on AWS

1. Gain access to the BDPA
   [AWS management console](https://aws.amazon.com/console/).

2. Navigate to `Services > WorkSpaces` from the Services menu.

3. [Create a Active Directory and each of the WorkSpaces](https://docs.aws.amazon.com/workspaces/latest/adminguide/launch-workspace-simple-ad.html).
   Be sure to record the administrator password for the directory in case it is
   needed later.

   - Use a Simple Active Directory ("simple AD").

     - DNS name should be `submissions.hscc.bdpa.org`.

     - DNS short name should be `hscc`.

     - [Enable Linux client access](https://docs.aws.amazon.com/workspaces/latest/userguide/amazon-workspaces-linux-client.html#linux-requirements).

   - Select the WorkSpace value bundle (or whichever bundle costs least this
     year).

     - Select Windows OS, smallest drive sizes, without Microsoft Office or any
       other software.

   - Select the "always on" WorkSpaces, not the "auto stop" WorkSpaces.

4. Login to each WorkSpace via
   [the desktop client](https://clients.amazonworkspaces.com) to ensure that the
   [recorded credentials](#step-1-setup-awsws-worksheet-in-the-hscc-tracking-document)
   work.

   Additionally, for each WorkSpace, you must add the chapter's abbreviation
   (three letters) to the task bar. This will make it easy for judges to figure
   out which chapter's WorkSpace they are looking at. To add a chapter
   abbreviation to the task bar:

   1. Right click on the empty portion of the Windows task bar on the right-side
      of the task bar, directly to the left of the up arrow that shows hidden
      icons.

   2. Select `Toolbars > New toolbar...`.

   3. Within the `Documents` folder, create a new folder called `XXX` where
      `XXX` represents the chapter's three-character abbreviation. These
      abbreviations can be found in the
      ["HSCC 2XXX Tracking" document on Google Drive](#step-1-setup-awsws-worksheet-in-the-hscc-tracking-document).

   4. Select this folder and click the "Select Folder" button.

   5. You should now see the three-character abbreviation on the right-side of
      the task bar.

### Step 3: Finalize Budget and Distribute Phase 1 Credentials

1. Decide on the "stop time," the moment when the WorkSpaces will be
   [deleted](https://docs.aws.amazon.com/workspaces/latest/adminguide/delete-workspaces.html)
   from AWS. For instance, if the conference is in mid-August, then some point
   in mid-September will suffice.

2. Report
   [projected monthly and total costs](https://aws.amazon.com/aws-cost-management/aws-cost-explorer/)
   (with respect to the "stop time") to NHSCC as early as possible.

3. Distribute WorkSpaces credentials and setup instructions to teams via Slack
   direct message to each chapter's coordinator. Use the following message
   template (replace the four `X`'s with their proper values):

> Good morning `X`,
>
> Same as last year, teams will be required to submit their solutions via Amazon
> WorkSpaces and the Reviewr submission portal. Have your team follow the steps
> below to get your Workspace up and running:
>
> 1. Download and install a WorkSpaces Client for your favorite devices:
>    https://clients.amazonworkspaces.com
> 2. Launch the client and enter the following registration code: `X`
> 3. Login with your password: `X`. Your username is `X`
>
> Keep in mind: students must know their WorkSpace and Reviewr submission portal
> credentials to complete PS2, even if it is the coordinators who are submitting
> PS1 on behalf of their team. If you need any assistance accessing your team's
> WorkSpace or you have any other questions or concerns about submitting, please
> let me know

4. Make an announcement on Slack via the `#_hscc` and `#announcements` channels
   that credentials have gone out and anyone who has not received theirs should
   contact you ASAP.

### Step 4: End Phase 1

At **[11:59PM Pacific Time](https://time.is/PT)** on the day the PS1 submission
window closes:

1. All WorkSpaces passwords (except the NHSCC WorkSpace) must be
   [reset](https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_manage_users_groups_reset_password.html)
   to the same judge-specific password. This can be done quickly from the
   "Directories" tab in the side bar.

2. WorkSpaces (except the NHSCC WorkSpace) must be
   [rebooted](https://docs.aws.amazon.com/workspaces/latest/adminguide/reboot-workspaces.html).

### Step 5: Prepare for Phase 2

Some time after judging for PS1 concludes, and **at least 30 minutes before
phase 2 begins**:

1. Each WorkSpace password (except the NHSCC WorkSpace) must be
   [reset](https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_manage_users_groups_reset_password.html)
   back to its original value. These values can be found in the
   ["HSCC 2XXX Tracking" document on Google Drive](#step-1-setup-awsws-worksheet-in-the-hscc-tracking-document).
   Password resets can be done quickly from the "Directories" tab in the side
   bar.

2. WorkSpaces (except the NHSCC WorkSpace) must be
   [rebooted](https://docs.aws.amazon.com/workspaces/latest/adminguide/reboot-workspaces.html).

### Step 6: End Phase 2

After the phase 2 submission grace period (usually exactly one hour after the
programming portion of phase 2 ends) concludes, teams must be locked out all
WorkSpaces instances. Specifically:

1. All WorkSpaces passwords (except the NHSCC WorkSpace) must be
   [reset](https://docs.aws.amazon.com/directoryservice/latest/admin-guide/ms_ad_manage_users_groups_reset_password.html)
   to the same judge-specific password. This can be done quickly from the
   "Directories" tab in the side bar.

2. WorkSpaces (except the NHSCC WorkSpace) must be
   [rebooted](https://docs.aws.amazon.com/workspaces/latest/adminguide/reboot-workspaces.html).

3. Each WorkSpace must be
   [configured to serve requests from the https://xxx.submissions.hscc.bdpa.org domain](#making-team-solutions-accessible-over-the-internet).
   This is usually handled by the chief judge.

### Step 7: Cleanup WorkSpaces

Around a month after the conference ends and inline with the "stop time"
determined in
[Step 3](#step-3-finalize-budget-and-distribute-phase-1-credentials), all
WorkSpaces should be stopped and
[permanently deleted](https://docs.aws.amazon.com/workspaces/latest/adminguide/delete-workspaces.html).

## Making Team Solutions Accessible Over The Internet

TODO
